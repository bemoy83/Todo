/* styles-ios.css - Essential iOS optimizations */

/* Root-level iOS fixes */
html {
  overscroll-behavior: none;
  touch-action: manipulation;
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
}

body {
  -webkit-overflow-scrolling: auto;
  touch-action: manipulation;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Enhanced touch-action strategy */
.task-card,
.main-task,
.subtask,
.swipe-wrap {
  touch-action: pan-x pan-y;
  will-change: transform;
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

/* Gesture-specific touch actions */
.swipe-wrap.swiping,
.card-swipe-wrap.swiping {
  touch-action: pan-x;
}

.task-card.armed,
.subtask.armed {
  touch-action: none;
}

/* Handle areas - must disable touch actions */
.sub-handle,
.card-handle {
  touch-action: none !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Input elements - prevent iOS zoom */
.add-input,
.add-sub-input,
.subtask-edit-input,
.task-title-edit-input,
input,
textarea {
  touch-action: manipulation;
  -webkit-user-select: text;
  user-select: text;
  font-size: 16px !important; /* Critical: prevents zoom on iOS */
}

/* Action buttons - precise touch targets */
.action {
  min-width: 44px;
  min-height: 44px;
  touch-action: manipulation;
  -webkit-user-select: none;
  user-select: none;
}

/* Enhanced scroll locking */
.lock-scroll {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  overscroll-behavior: none !important;
}

/* Better drag ghost on iOS */
.drag-ghost {
  transform: translate3d(0, 0, 0);
  will-change: transform;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  pointer-events: none;
  touch-action: none;
}

/* iOS Safe Area handling */
.topbar {
  padding-top: max(var(--space-sm), env(safe-area-inset-top));
}

.add-bar {
  padding-bottom: calc(var(--space-md) + env(safe-area-inset-bottom));
}

/* Prevent iOS zoom on specific viewport sizes */
@media screen and (max-width: 414px) {
  input, textarea, select {
    font-size: 16px !important;
  }
}

/* Enhanced focus states for iOS */
input:focus,
textarea:focus {
  outline: none;
  box-shadow: 
    inset 2px 2px 4px var(--neuro-shadow-dark),
    inset -2px -2px 4px var(--neuro-shadow-light),
    0 0 0 2px rgba(59, 130, 246, 0.3);
}

/* Performance optimizations for iOS */
.task-card,
.subtask,
.drag-ghost {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  will-change: transform, opacity;
}

/* iOS-specific momentum scroll fix */
.app {
  -webkit-overflow-scrolling: auto;
  overscroll-behavior: none;
}

/* Action button touch improvements */
.swipe-actions .action,
.card-swipe-actions .action {
  min-width: 48px;
  min-height: 48px;
  transition: transform 100ms ease;
}

.swipe-actions .action:active,
.card-swipe-actions .action:active {
  transform: scale(0.9);
}

/* Menu touch improvements */
.menu-item {
  min-height: 48px;
  -webkit-user-select: none;
  user-select: none;
}

/* Improved placeholder visibility during drag */
.placeholder {
  background: rgba(59, 130, 246, 0.1);
  border: 2px dashed rgba(59, 130, 246, 0.3);
  min-height: 8px;
}